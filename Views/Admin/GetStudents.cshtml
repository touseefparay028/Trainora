@model IEnumerable<LearningManagementSystem.Models.DTO.BatchVM>

@{
    ViewData["Title"] = "Students";
    Layout = "~/Views/Shared/AdminLayout.cshtml";
}

<h2>Students List by Batch</h2>

@if (Model == null || !Model.Any())
{
    <div class="alert alert-info text-center mt-3">
        No students found.
    </div>
}
else
{
    <div class="accordion" id="batchAccordion">
        @for (int i = 0; i < Model.Count(); i++)
        {
            var batchItem = Model.ElementAt(i);
            <div class="accordion-item">
                <h2 class="accordion-header" id="heading@i">
                    <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapse@i" aria-expanded="false" aria-controls="collapse@i">
                        @batchItem.Name
                    </button>
                </h2>
                <div id="collapse@i" class="accordion-collapse collapse" aria-labelledby="heading@i" data-bs-parent="#batchAccordion">
                    <div class="accordion-body">
                        @if (batchItem.ApplicationUser.Any())
                        {
                            <table class="table table-bordered table-striped mb-0">
                                <thead>
                                    <tr>
                                        <th>Full Name</th>
                                        <th>Email</th>
                                    <th>Enrollment Number</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    @foreach (var student in batchItem.ApplicationUser)
                                    {
                                        <tr>
                                            <td>@student.Name</td>
                                            <td>@student.Email</td>
                                            <td>@student.EnrollmentNumber</td>
                                            
                                        </tr>
                                    }
                                </tbody>
                            </table>
                        }
                        else
                        {
                            <div class="text-muted">No students in this batch.</div>
                        }
                    </div>
                </div>
            </div>
        }
    </div>
}
